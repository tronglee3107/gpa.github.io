<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="style.css">
    <title>GPA</title>
</head>

<body>
    <h1>K√©o th·∫£ n√∫t n√†y l√™n thanh bookmark üòé</h1>
    <a class="link" href="javascript: (function gpa() { console.clear(); const currentHref = window.location.href; const dkhpReg = /.portal([1-9]|)\.hcmus\.edu\.vn\/SinhVien\.aspx\?(.*)pid=211/; let tab; if(!currentHref.match(dkhpReg)) { const portalReg = /.portal([1-9]|)\.hcmus\.edu\.vn/; if(currentHref.match(portalReg)) { alert(&quot;Vui l√≤ng ƒëi t·ªõi trang \&quot;Tra c·ª©u K·∫øt qu·∫£ h·ªçc t·∫≠p\&quot; tr∆∞·ªõc&quot;); } return; }; var dataArray = $(&quot;#aspnetForm&quot;).serializeArray(); var param = dataArray.reduce(function(a, x) { a[x.name] = x.value; return a; }, {});; const isAllSection = param['ctl00$ContentPlaceHolder1$ctl00$cboNamHoc_gvDKHPLichThi$ob_CbocboNamHoc_gvDKHPLichThiTB'] == '--T·∫•t c·∫£--'; let semeterInput = $('input[name=&quot;ctl00$ContentPlaceHolder1$ctl00$cboHocKy_gvDKHPLichThi$ob_CbocboHocKy_gvDKHPLichThiTB&quot;]'); if(semeterInput) semeterInput = semeterInput[0]; else return; const isSemeterDisabled = $(semeterInput).attr('disabled') || $(semeterInput).prop('disabled'); if(!isAllSection || isSemeterDisabled) { param['ctl00$ContentPlaceHolder1$ctl00$cboNamHoc_gvDKHPLichThi$ob_CbocboNamHoc_gvDKHPLichThiTB'] = '--T·∫•t c·∫£--'; param['ctl00$ContentPlaceHolder1$ctl00$cboNamHoc_gvDKHPLichThi$ob_CbocboNamHoc_gvDKHPLichThiSIS'] = '0'; param['ctl00$ContentPlaceHolder1$ctl00$cboNamHoc_gvDKHPLichThi'] = '0'; param['ctl00$ContentPlaceHolder1$ctl00$cboHocKy_gvDKHPLichThi$ob_CbocboHocKy_gvDKHPLichThiTB'] = '1'; param['ctl00$ContentPlaceHolder1$ctl00$cboHocKy_gvDKHPLichThi$ob_CbocboHocKy_gvDKHPLichThiSIS'] = '0'; param['ctl00$ContentPlaceHolder1$ctl00$cboHocKy_gvDKHPLichThi'] = '1'; param['ctl00$ContentPlaceHolder1$ctl00$btnXemDiemThi'] = 'Xem K·∫øt Qu·∫£ H·ªçc T·∫≠p'; const parentDiv = $(&quot;#lich-thi-dkhp&quot;)[0]; if(parentDiv&amp;&amp;!$(&quot;#loading-text&quot;)[0]) parentDiv.prepend($('<div id=&quot;loading-text&quot; style=&quot;font-size:20px; color:#1B486A;text-align:center;margin:10px;&quot;>Ch·ªù m·ªôt ch√∫t...</div>')[0]); $.ajax({ type: &quot;POST&quot;, url: &quot;/SinhVien.aspx?pid=211&quot;, data: param, success: function(res) { let html = $.parseHTML(res); let HK = $(html).find(&quot;input[name='ctl00$ContentPlaceHolder1$ctl00$cboNamHoc_gvDKHPLichThi$ob_CbocboNamHoc_gvDKHPLichThiTB']&quot;); if(HK) console.log($(HK[0]).attr(&quot;value&quot;)); var newDoc = document.open(&quot;text/html&quot;, &quot;replace&quot;); newDoc.write(res); newDoc.close(); gpa(); }, }); return; } tab = $(&quot;#tbDiemThiGK&quot;); const exceptCourses = [ &quot;Anh vƒÉn&quot;, &quot;Gi√°o d·ª•c qu·ªëc ph√≤ng&quot;, &quot;Th·ªÉ d·ª•c&quot;, &quot;Anh van&quot;, &quot;Giao duc quoc phong&quot;, &quot;The duc&quot; ]; if (tab) { let mainTable = tab[0]; let rows = tab.find(&quot;tbody tr&quot;); let data = []; let exceptData = []; for (let i = 0; i < rows.length; i++) { const tds = $(rows[i]).find(&quot;td&quot;).not(&quot;.gpa-checkbox&quot;); let row = { id: i + 1, semester: $(tds[0]).text().trim().normalize(), course: $(tds[1]).text().trim().normalize(), credit: parseInt($(tds[2]).text().trim().normalize()), class: $(tds[3]).text().trim().normalize(), ldcode: $(tds[4]).text().trim().normalize(), score: parseFloat($(tds[5]).text().trim().normalize()), note: $(tds[6]).text().trim().normalize(), include: true, whyExclude: &quot;&quot; }; if(!row.credit) {row.credit = 0; row.include = false; row.whyExclude += &quot;H·ªçc ph·∫ßn kh√¥ng t√≠n ch·ªâ&quot;; } else if(!row.score) {row.score = 0; row.include = false; row.whyExclude +=&quot;Ch∆∞a ho·∫∑c kh√¥ng c√≥ ƒëi·ªÉm&quot;; } else if (row.score < 5) { row.include = false; row.whyExclude += &quot;ƒêi·ªÉm nh·ªè h∆°n 5, ch∆∞a qua m√¥n. &quot;; } else { let include = true; for (let j = 0; j < exceptCourses.length; j++) { if (row.course.includes(exceptCourses[j])) { include = false; row.whyExclude += &quot;H·ªçc ph·∫ßn kh√¥ng t√≠nh trong GPA. &quot;; break; } }; row.include = include; } for (let j = 0; j < data.length; j++) { if (data[j].course == row.course) { data[j].include = false; if(!data[j].whyExclude.includes(&quot;ƒê√£ h·ªçc l·∫°i&quot;)) data[j].whyExclude += &quot;ƒê√£ h·ªçc l·∫°i. &quot;; } } data.push(row); if (!row.include) exceptData.push(row); } let totalCredits = 0; let totalScores = 0; let gpa = 0; let howICalculated = &quot;%c ƒêi·ªÉm t√≠nh th·∫ø n√†o nh·ªü ?%c \n\n&quot;; let cssLog = [&quot;font-size:16px&quot;, &quot;font-size:normal&quot;]; for (let i = 0; i < data.length; i++) { let item = data[i]; if (item.include) { totalCredits += item.credit; totalScores += item.credit * item.score; howICalculated += &quot; &quot; + item.course + &quot;:%c &quot; + item.score + &quot;%c x%c &quot; + item.credit + &quot;%c =%c &quot; + item.credit * item.score + &quot;%c \n&quot;; cssLog.push(&quot;font-weight:bold;&quot;); cssLog.push(&quot;font-weight:normal;&quot;); cssLog.push(&quot;font-weight:bold;&quot;); cssLog.push(&quot;font-weight:normal;&quot;); cssLog.push(&quot;font-weight:bold;&quot;); cssLog.push(&quot;font-weight:normal;&quot;); } else { howICalculated += &quot;%c &quot; + item.course + &quot;: &quot; + item.score + &quot; x &quot; + item.credit + &quot;%c \n&quot;; cssLog.push(&quot;color:orange;text-decoration: line-through;&quot;); cssLog.push(&quot;color:black;&quot;); } } gpa = totalScores / totalCredits; let removedCoursesSize= 0; for(let i =0;i< data.length;i++) if(!data[i].include) removedCoursesSize++; console.log(&quot;%c \n Ch√†o nh√©, GPA n√®:\n %c&quot; + gpa + &quot;\n&quot;, &quot;color:black&quot;, &quot;color:blue; font-size: 30px;&quot;); console.log(&quot;%c \n T·ªïng t√≠n ch·ªâ:\n %c&quot; + totalCredits + &quot;\n&quot;, &quot;color:black&quot;, &quot;color:blue; font-size: 30px;&quot;); console.log(&quot;%c \n T·ªïng ƒëi·ªÉm:\n %c&quot; + totalScores + &quot;\n&quot;, &quot;color:black&quot;, &quot;color:blue; font-size: 30px;&quot;); console.log(&quot;%c \n T·ªïng h·ªçc ph·∫ßn:\n %c&quot; + data.length + &quot;\n&quot;, &quot;color:black&quot;, &quot;color:blue; font-size: 30px;&quot;); console.log(&quot;%c \n T·ªïng h·ªçc ph·∫ßn trong GPA:\n %c&quot; + (data.length - removedCoursesSize) + &quot;\n&quot;, &quot;color:black&quot;, &quot;color:blue; font-size: 30px;&quot;); howICalculated += &quot;-------------\n&quot; + &quot;GPA : %c &quot; + totalScores + &quot; / &quot; + totalCredits + &quot; = &quot; + gpa; cssLog.push(&quot;font-weight:bold&quot;); let removedSection = &quot;%c Kh√¥ng bao g·ªìm nh·ªØng h·ªçc ph·∫ßn sau ƒë√¢y: \n\n%c&quot;; let removedCss = [&quot;font-size:16px&quot;, &quot;font-size:normal&quot;]; for (let i = 0; i < exceptData.length; i++) { removedSection += &quot;%c lo·∫°i b·ªè: %c&quot; + exceptData[i].course + &quot; (&quot; + exceptData[i].semester + &quot;)&quot; + &quot;\n%c l√Ω do: %c&quot; + exceptData[i].whyExclude + &quot;\n\n%c&quot;; removedCss.push(&quot;color:black&quot;); removedCss.push(&quot;color:blue&quot;); removedCss.push(&quot;color:black&quot;); removedCss.push(&quot;color:red&quot;); removedCss.push(&quot;color:black&quot;); } removedSection += &quot;%c &quot; + removedCoursesSize + &quot; h·ªçc ph·∫ßn ƒë√£ lo·∫°i b·ªè.%c\n&quot;; removedCss.push(&quot;color:red&quot;); removedCss.push(&quot;color:black&quot;); console.log(removedSection, ...removedCss); console.log(howICalculated, ...cssLog); console.log(&quot;(K√©o l√™n ƒë·ªÉ xem chi ti·∫øt)&quot;); let headTr = tab.find(&quot;thead tr&quot;)[0]; if ($(headTr).find(&quot;th&quot;).length < 8) { let headTh = $($(headTr).find(&quot;th&quot;)[0]).clone(); $(headTh).attr(&quot;title&quot;, &quot;T√≠nh hay kh√¥ng t√≠nh h·ªçc ph·∫ßn n√†y trong GPA&quot;); $(headTh).children().html(&quot;Trong GPA&quot;); $(headTr).prepend(headTh); for (let i = 0; i < rows.length; i++) { $(rows[i]).prepend('<td class= &quot;center gpa-checkbox&quot; style=&quot;width:60px;&quot; ><input type=&quot;checkbox&quot;' + ((data[i].include) ? &quot; checked &quot; : &quot;&quot;) + ' /></td>'); if(!data[i].include) { if(data[i].whyExclude.includes(&quot;kh√¥ng t√≠nh&quot;)) $(rows[i]).attr(&quot;style&quot;,&quot;color:blue;text-decoration: line-through;&quot;); else $(rows[i]).attr(&quot;style&quot;,&quot;color:red;text-decoration: line-through;&quot;); } } let parentDiv = $(&quot;#lich-thi-dkhp&quot;)[0]; let gpaFieldSet = $('<fieldset><legend>Th·ªëng k√™ GPA</legend><div id=&quot;tbGPA_wrapper&quot; class=&quot;dataTables_wrapper&quot; rold=&quot;grid&quot;><table id=&quot;tbGPA&quot; class=&quot;dkhp-table dataTable&quot;><thead></thead><tbody role=&quot;alert&quot; aria-live=&quot;polite&quot; aria-relevant=&quot;all&quot;></tbody></table></div><p style=&quot;margin-top: 10px; color: blue;&quot;><strong>(*)</strong>: Nh·∫•n Ctr+Shift+I v√† ch·ªçn tab Console ƒë·ªÉ xem chi ti·∫øt t√≠nh to√°n.<br>&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;N·∫øu b·∫°n th·∫•y h·ªØu √≠ch, h√£y t·∫∑ng m√¨nh m·ªôt Star <a href=&quot;https://github.com/dtrung98/GPABookmarklet&quot;>T·∫°i ƒê√¢y</a> nh√© ^^</p></fieldset>'); let gpaTableHead = $(gpaFieldSet).find(&quot;thead&quot;)[0]; let gpaTableBody = $(gpaFieldSet).find(&quot;tbody&quot;)[0]; const gpaHeadCol1 = $($(headTr).find(&quot;th&quot;)[2]).clone(); $(gpaHeadCol1).attr(&quot;title&quot;,&quot;T√™n m·ª•c&quot;); $(gpaHeadCol1).children().html(&quot;T√™n m·ª•c&quot;); const gpaHeadCol2 = headTh.clone(); $(gpaHeadCol2).attr(&quot;title&quot;,&quot;Gi√° tr·ªã&quot;); $(gpaHeadCol2).children().html(&quot;Gi√° tr·ªã&quot;); $(gpaTableHead).append(gpaHeadCol1); $(gpaTableHead).append(gpaHeadCol2); $(gpaTableBody).append('<tr class=&quot;odd&quot;><td class=&quot;left &quot;>ƒêi·ªÉm trung b√¨nh t√≠ch l≈©y (GPA)</td><td class=&quot;center gpa&quot;><b>'+gpa+'</b></td></tr>'); $(gpaTableBody).append('<tr class=&quot;even&quot;><td class=&quot;left&quot;>T·ªïng t√≠n ch·ªâ ƒë√£ t√≠ch lu·ªπ</td><td class=&quot;center gpa&quot;>'+totalCredits+' t√≠n ch·ªâ</td></tr>'); $(gpaTableBody).append('<tr class=&quot;odd&quot;><td class=&quot;left&quot;>T·ªïng ƒëi·ªÉm ƒë√£ t√≠ch l≈©y</td><td class=&quot;center gpa&quot;>'+totalScores+'</td></tr>'); $(gpaTableBody).append('<tr class=&quot;even&quot;><td class=&quot;left&quot;>S√¥ h·ªçc ph·∫ßn ƒë√£ h·ªçc</td><td class=&quot;center gpa&quot;>'+data.length+' h·ªçc ph·∫ßn</td></tr>'); $(gpaTableBody).append('<tr class=&quot;odd&quot;><td class=&quot;left&quot;>S·ªë h·ªçc ph·∫ßn t√≠nh trong GPA</td><td class=&quot;center gpa&quot;>'+(data.length - removedCoursesSize)+' h·ªçc ph·∫ßn</td></tr>'); $(parentDiv).prepend(gpaFieldSet); } else { for(let i = 0;i <rows.length;i++) { if(data[i].include) $($(rows[i]).find(&quot;input&quot;)[0]).attr('checked', 'checked'); else $($(rows[i]).find(&quot;input&quot;)[0]).removeAttr('checked'); } } } } )();"> <button class="button-85" role="button"></button>T√≠nh GPA </button></a>

</body>

</html>